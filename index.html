<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>lhyå’Œzknçš„äº‘åŸºåœ° ğŸ§¸</title>
    <!-- å¼•å…¥ Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
    /* ================= åŸºç¡€æ ·å¼ä¼˜åŒ– ================= */
    :root { 
        --primary-color: #ff6b81; 
        --hover-color: #ff4757; 
        --bg-color: #fcfcfc; /* æ›´å¹²å‡€çš„èƒŒæ™¯è‰² */
        --text-color: #4a4a4a; 
        --card-bg: #ffffff;
        --shadow: 0 10px 30px rgba(0, 0, 0, 0.05); /* æ›´æŸ”å’Œçš„é«˜çº§é˜´å½± */
    }
    
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body { 
        font-family: 'Microsoft YaHei', 'PingFang SC', sans-serif; 
        background-color: var(--bg-color); 
        color: var(--text-color); 
        overflow-x: hidden; 
        line-height: 1.8; /* å¢åŠ è¡Œé«˜ï¼Œè®©æ–‡å­—ä¸æ‹¥æŒ¤ */
        font-size: 16px;
    }
    
    /* å¯¼èˆªæ  */
    header { 
        position: fixed; top: 0; left: 0; width: 100%; height: 70px; 
        background-color: rgba(255, 255, 255, 0.85); 
        backdrop-filter: blur(12px); /* æ¯›ç»ç’ƒæ•ˆæœæ›´å¼º */
        box-shadow: 0 1px 15px rgba(0, 0, 0, 0.03); 
        z-index: 1000; 
        display: flex; justify-content: center; align-items: center; 
    }
    .header-inner { width: 92%; max-width: 1200px; display: flex; justify-content: space-between; align-items: center; }
    .logo { font-size: 1.5rem; font-weight: 800; color: var(--primary-color); letter-spacing: 1px; }
    .nav-list { display: flex; list-style: none; gap: 25px; }
    .nav-item a { 
        text-decoration: none; color: #666; font-weight: 500; padding: 8px 18px; 
        border-radius: 25px; transition: all 0.3s ease; 
    }
    .nav-item a.active, .nav-item a:hover { 
        background-color: var(--primary-color); color: white; 
        box-shadow: 0 4px 12px rgba(255, 107, 129, 0.3); 
    }

    /* æ¿å—é€šç”¨å¸ƒå±€ä¼˜åŒ– */
    .section { display: none; min-height: 100vh; animation: fadeIn 0.6s cubic-bezier(0.22, 1, 0.36, 1); }
    .section.active { display: block; }
    
    .content-section { 
        padding-top: 130px; /* å¢åŠ é¡¶éƒ¨è·ç¦»ï¼Œä¸è¢«å¯¼èˆªæ æŒ¡ä½ */
        padding-bottom: 80px; 
        max-width: 1000px; /* é™åˆ¶æœ€å¤§å®½åº¦ï¼Œè®©å†…å®¹æ›´èšç„¦ï¼Œä¸æ¾æ•£ */
        margin: 0 auto; 
        width: 92%; 
    }
    
    h2 { 
        text-align: center; 
        font-size: 2rem; 
        margin-bottom: 50px; 
        color: #333;
        position: relative;
        display: inline-block;
        width: 100%;
    }
    /* æ ‡é¢˜ä¸‹æ–¹çš„å°è£…é¥°çº¿ */
    h2::after {
        content: ''; display: block; width: 50px; height: 4px; 
        background: var(--primary-color); margin: 15px auto 0; 
        border-radius: 2px; opacity: 0.6;
    }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    /* ä¸»é¡µ */
    #home { padding: 0 !important; height: 100vh; width: 100%; }
    .home-slider, .slider-img { width: 100%; height: 100%; object-fit: cover; }
    .slider-img { position: absolute; top: 0; left: 0; }
    .slider-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; z-index: 10; width: 100%; }
    .slider-text { 
        font-size: 3rem; color: white; font-weight: bold; margin-bottom: 50px; 
        text-shadow: 0 4px 20px rgba(0,0,0,0.3); letter-spacing: 2px; 
    }
    .music-btn { 
        background: var(--primary-color); color: white; 
        border: none; padding: 16px 45px; font-size: 1.1rem; 
        border-radius: 50px; cursor: pointer; transition: all 0.3s;
        box-shadow: 0 8px 20px rgba(255, 107, 129, 0.4);
        font-weight: bold;
    }
    .music-btn:hover { transform: translateY(-3px) scale(1.02); background: var(--hover-color); box-shadow: 0 12px 25px rgba(255, 107, 129, 0.5); }

    /* ç›¸å†Œ - å¢åŠ ç•™ç™½ */
    .upload-area { 
        background: var(--card-bg); padding: 40px; border-radius: 25px; 
        box-shadow: var(--shadow); text-align: center; margin-bottom: 60px; 
    }
    .year-badge { 
        background: #fff; color: var(--primary-color); border: 2px solid var(--primary-color);
        padding: 6px 20px; border-radius: 30px; display: inline-block; 
        margin: 30px 0 20px; font-weight: bold; font-size: 1.1rem;
    }
    .img-grid { 
        display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); 
        gap: 20px; /* å¢åŠ å›¾ç‰‡é—´è· */
    }
    
    .img-item { 
        aspect-ratio: 1; overflow: hidden; border-radius: 15px; 
        background: #fff; position: relative; cursor: zoom-in;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05); transition: transform 0.3s;
    }
    .img-item:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
    .img-item img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
    
    .delete-btn {
        position: absolute; top: 10px; right: 10px;
        background: rgba(255, 255, 255, 0.9); color: #ff4757;
        border: none; width: 32px; height: 32px; border-radius: 50%;
        cursor: pointer; z-index: 5; font-size: 18px;
        display: flex; align-items: center; justify-content: center;
        opacity: 0; transition: all 0.3s; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .img-item:hover .delete-btn { opacity: 1; }
    @media (hover: none) { .delete-btn { opacity: 1; } }

    /* ç¯ç®± */
    .lightbox {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0, 0, 0, 0.92); display: none; 
        justify-content: center; align-items: center; z-index: 2000; cursor: zoom-out;
    }
    .lightbox.active { display: flex; animation: fadeIn 0.3s; }
    .lightbox img { max-width: 90%; max-height: 90%; border-radius: 8px; box-shadow: 0 0 30px rgba(0,0,0,0.5); cursor: default; }
    .close-lightbox { position: absolute; top: 30px; right: 40px; color: white; font-size: 50px; cursor: pointer; opacity: 0.8; transition: 0.2s; }
    .close-lightbox:hover { opacity: 1; }

    /* ä¿¡ä»¶ - ä¼˜åŒ–çº¸å¼ è´¨æ„Ÿ */
    .letter-paper { 
        background: #fff linear-gradient(#f3f3f3 1px, transparent 1px) 0 0 / 100% 2.4em; /* è°ƒæ•´çº¿æ¡é—´è· */
        padding: 60px; /* å¢åŠ å†…è¾¹è· */
        font-family: 'KaiTi', 'STKaiti', serif; 
        font-size: 1.2rem; /* å­—ä½“åŠ å¤§ */
        line-height: 2.4em; /* ä¸çº¿æ¡å¯¹å…¶ */
        white-space: pre-wrap; 
        box-shadow: 0 15px 40px rgba(0,0,0,0.06); 
        border-radius: 5px;
        color: #2c3e50;
        position: relative;
    }
    /* ä¿¡çº¸é¡¶éƒ¨è£…é¥° */
    .letter-paper::before {
        content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 8px;
        background: repeating-linear-gradient(45deg, #ff6b81, #ff6b81 10px, #fff 10px, #fff 20px, #7bed9f 20px, #7bed9f 30px, #fff 30px, #fff 40px);
    }

    /* æ¸¸æˆ */
    .game-area { text-align: center; background: white; padding: 50px; border-radius: 30px; box-shadow: var(--shadow); }
    .memory-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-top: 30px; max-width: 600px; margin-left: auto; margin-right: auto; }
    .memory-card { height: 110px; position: relative; transform-style: preserve-3d; transition: 0.5s; cursor: pointer; }
    .memory-card.flip { transform: rotateY(180deg); }
    .front-face, .back-face { width: 100%; height: 100%; position: absolute; backface-visibility: hidden; display: flex; align-items: center; justify-content: center; font-size: 2.8rem; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.08); }
    .front-face { background: white; transform: rotateY(180deg); border: 2px solid #f0f0f0; }
    .back-face { background: var(--primary-color); background-image: linear-gradient(135deg, #ff6b81, #ff4757); }
    .gift-reveal { display: none; margin-top: 40px; animation: popUp 0.8s; }
    .password-code { font-size: 4rem; color: var(--primary-color); font-weight: 800; margin: 20px 0; letter-spacing: 5px; }
    
    #fireworksCanvas { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 2000; }
    
    @media (max-width: 768px) {
        .header-inner { flex-direction: column; width: 100%; } 
        header { height: auto; padding: 15px 0; background: rgba(255,255,255,0.98); } 
        .content-section { padding-top: 160px; width: 95%; }
        .memory-grid { grid-template-columns: repeat(3, 1fr); }
        .letter-paper { padding: 30px; font-size: 1rem; line-height: 2em; background-size: 100% 2em; }
        .slider-text { font-size: 2rem; }
    }
    </style>
</head>
<body>
    <canvas id="fireworksCanvas"></canvas>

    <!-- ç¯ç®± -->
    <div id="lightbox" class="lightbox" onclick="closeLightbox()">
        <span class="close-lightbox">&times;</span>
        <img id="lightbox-img" src="" onclick="event.stopPropagation()"> 
    </div>

    <header>
        <div class="header-inner">
            <div class="logo">lhyå’Œzknçš„äº‘åŸºåœ° ğŸ§¸</div>
            <nav>
                <ul class="nav-list">
                    <li class="nav-item"><a href="#home" class="active" data-target="home">ä¸»é¡µ</a></li>
                    <li class="nav-item"><a href="#collection" data-target="collection">æ”¶é›†ç®±</a></li>
                    <li class="nav-item"><a href="#letter" data-target="letter">20å²çš„ä¿¡</a></li>
                    <li class="nav-item"><a href="#gift" data-target="gift">è§£é”ç¤¼ç‰©</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section id="home" class="section active">
        <div class="home-slider">
            <!-- è¯·ç¡®ä¿å›¾ç‰‡è·¯å¾„æ­£ç¡® -->
            <img src="images/home/1.jpg" class="slider-img" style="display:block">
            <img src="images/home/2.jpg" class="slider-img" style="display:none">
            <img src="images/home/3.jpg" class="slider-img" style="display:none">
            <div class="slider-content">
                <div class="slider-text">è¿™ä¸–ç•Œæœ‰é‚£ä¹ˆä¸ªäºº<br>æ´»åœ¨æˆ‘é£æ‰¬çš„é’æ˜¥</div>
                <button class="music-btn" id="playMusicBtn">ç‚¹ç‚¹æˆ‘å§ ğŸµ</button>
            </div>
            <audio id="bgMusic" loop src="https://music.163.com/song/media/outer/url?id=1933605915.mp3"></audio>
        </div>
    </section>

    <section id="collection" class="section content-section">
        <h2>æˆ‘ä»¬çš„å›å¿†æ”¶é›†ç®± ğŸ“¦</h2>
        <div class="upload-area">
            <p style="margin-bottom:20px; color:#777;">âœ¨ å¤©å—åœ°åŒ—çš„ç…§ç‰‡æ”¶é›†ç®± âœ¨<br>å¯ä»¥æ·»åˆ ã€æ”¾å¤§å’Œå·¦å³ç¿»çœ‹å•¦ï¼Œæ·»åŠ æˆ–åˆ é™¤ç…§ç‰‡åç¨ç­‰ä¸€å°ä¼šå³å¯</p>
            
            <div style="display: flex; justify-content: center; gap: 15px; align-items: center; flex-wrap: wrap;">
                <input type="file" id="uploadInput" accept="image/*" style="display: none;">
                <button onclick="document.getElementById('uploadInput').click()" class="music-btn" style="padding: 10px 30px; font-size: 1rem; box-shadow:none;">â• ä¸Šä¼ ç…§ç‰‡</button>
                
                <!-- è¿™é‡Œçš„å¹´ä»½å·²ç»æ›´æ–° -->
                <select id="yearSelect" style="padding: 12px 20px; border-radius: 30px; border: 2px solid #eee; background: white; font-size: 1rem; outline: none; cursor: pointer;">
                    <option value="2027å¹´">2027å¹´</option>
                    <option value="2026å¹´">2026å¹´</option>
                    <option value="2025å¹´" selected>2025å¹´</option>
                    <option value="2024å¹´">2024å¹´</option>
                    <option value="2023å¹´">2023å¹´</option>
                    <option value="2022å¹´">2022å¹´</option>
                    <option value="2021å¹´">2021å¹´</option>
                </select>
            </div>
            <p id="uploadStatus" style="color: var(--primary-color); margin-top: 15px; font-weight: bold; min-height: 24px;"></p>
        </div>
        <div id="dynamicGallery">
            <p style="text-align:center; color:#999; margin-top: 50px;">â˜ï¸ æ­£åœ¨è¿æ¥äº‘ç«¯æ•°æ®åº“...</p>
        </div>
    </section>

    <section id="letter" class="section content-section">
        <h2>è‡´20å²çš„æˆ‘ä»¬ âœ‰ï¸</h2>
        <!-- ä¿¡çº¸ -->
        <div class="letter-paper">
å†™ç»™20å²çš„lhy:

è¿™æ˜¯ä¸€å°è¿Ÿæ¥äº†å¾ˆä¹…çš„ç”Ÿæ—¥ä¿¡ï¼Œä½†æ˜¯è¿˜æ˜¯æ¥å•¦ã€‚
ç¥ç”Ÿæ—¥å¿«ä¹ï¼ğŸ°
æ–°å¹´å¿«ä¹ï¼ğŸ†
å¤©å¤©å¿«ä¹ï¼â¤ï¸

ç«Ÿç„¶çœŸçš„æŠŠä¿¡åšæˆäº†ç¼–ç¨‹çš„å½¢å¼ï¼Œå»å¹´æˆ‘å…¶å®åªæ˜¯éšå£ä¸€è¯´ï¼Œè¿ç¼–ç¨‹æ˜¯ä»€ä¹ˆéƒ½ä¸å¤ªæ¸…æ¥šï¼Œä½†æ˜¯æ„Ÿè°¢aiã€‚
æ„Ÿè°¢ä»Šå¹´è“¬å‹ƒå‘å±•çš„äººå·¥æ™ºèƒ½è¡Œä¸šï¼Œæ„Ÿè°¢è±†åŒ…ã€Geminiã€å°çº¢ä¹¦ã€Bç«™æ•™ç¨‹å¯¹æœ¬ç½‘é¡µçš„å¤§åŠ›æ”¯æŒã€‚
æ¥ï¼Œä¸€é èº¬ï¼

è™½ç„¶è¿™ä¸ªç½‘é¡µç°åœ¨æ¯”è¾ƒåŸºç¡€ï¼Œä½†å®ƒå¯ä»¥ä¸€ç›´ç•™ä¸‹æ¥ï¼Œå˜æˆæˆ‘ä»¬çš„äº‘åŸºåœ°ï¼Œæ…¢æ…¢å˜å¾—è¶Šæ¥è¶Šä¸°å¯Œã€ç²¾å½©ï¼Œæµªæ¼«å¾—å¾ˆå•ŠçœŸçš„æ˜¯ã€‚
è¿˜èƒ½ç­‰åˆ°æˆ‘å˜æˆç¼–ç¨‹é«˜æ‰‹çš„é‚£ä¸€å¤©ï¼Œè¿æ¥åä¸½å¤§å˜èº«ã€‚
æ„Ÿè°¢ç°ä»£ç§‘æŠ€ã€‚
æ¥ï¼ŒäºŒé èº¬ï¼

ä¸è¡Œæˆ‘è¿˜æ˜¯è¦ç…½æƒ…ã€‚
æ€ä¹ˆæˆ‘ä»¬çªç„¶å°±äº’ç›¸å†™ä¿¡æœ‰ä¸‰å¹´äº†ï¼Œæ˜¯ä¸æ˜¯å¥½ç¥å¥‡ï¼Œå¥½åƒæ˜¨å¤©è¿˜æ˜¯äº’ç›¸é—®é¢˜ç›®å’Œä¸çŸ¥é“è€ƒå“ªé‡Œçš„é«˜ä¸­ç”Ÿï¼Œæ˜å¹´å°±åˆè¦åˆ°æ–°çš„åœ°æ–¹å»äº†ã€‚
é«˜ä¸­å¤§å­¦ï¼Œæˆ‘ä»¬è®¤è¯†å¿«ä¸¤ä¸ªä¸‰å¹´äº†è¯¶ã€‚
æˆ‘å–œæ¬¢ã€‚

20å²å•¦æˆ‘ä»¬éƒ½ã€‚
æ„Ÿè§‰20å²æ˜¯ä¸€ä¸ªå¾ˆåƒå¤§äººçš„å¹´çºªï¼Œæˆ‘ä»¬çš„ç”Ÿæ—¥å½“å¤©éƒ½å¾ˆå¤§äººï¼Œä½ ä¸Šä¸€å¤©è¯¾æˆ‘è€ƒä¸€å¤©è¯•ï¼Œæœ¬æ¥æƒ³å¥½å¯ä»¥å›å®¶çš„æ—¥å­ä¹Ÿå¿™ä¸è¿‡æ¥ï¼Œå¿™äº†ä¸€é˜µåˆä¸€é˜µã€‚
è€Œ19å²çš„æˆ‘ä»¬éƒ½å¥½å‰å®³ã€‚
æˆ‘çœ¼é‡Œçš„ä½ ä¸€ç›´åœ¨åŠªåŠ›å‰è¿›ï¼Œä¸€è¾¹å’’éª‚é‚ªæ¶è€<span style="text-decoration: line-through;">å¥¶</span>å¸ˆçš„pushä¸€è¾¹ç»§ç»­åšçš„å¾ˆå¥½ã€‚é‚£æ®µæ—¶é—´ä½ çœŸçš„å¾ˆå‘½è‹¦ï¼Œæˆ‘æ¯æ¬¡å¬åˆ°ä½ è·Ÿæˆ‘æ‰“ç”µè¯åæ§½çš„æ—¶å€™éƒ½ä¹å¾—ä¸è¡Œï¼Œç„¶ååœ¨å®¿èˆæ¥¼ä¸‹ç¬‘æˆå¤§å‚»å­ã€‚
ä½†èªæ˜çš„æˆ‘å‘ç°äº†ï¼Œä½ çš„èƒ½åŠ›çœŸçš„å¾ˆå¼ºã€‚æˆ‘å‡ ä¹å¯ä»¥æƒ³è±¡å¾—åˆ°ï¼Œä½ çš„èƒ½åŠ›æ˜¯æ€ä¹ˆè®©é‚£ä¸ªè€å¸ˆä½©æœä¸”ä¿¡ä»»çš„ï¼Œæ‰€ä»¥æ‰å¯¹ä½ å§”ä»¥é‡ä»»ï¼Œå°½ç®¡è¿™ä¸ªé‡ä»»æœ‰ç‚¹è®¨åŒã€‚
è€Œä¸”åšæŒåŠªåŠ›ä¸Šè¯¾ï¼Œåˆ·åˆ†ï¼Œå›ç­”é—®é¢˜ï¼Œä¸»åŠ¨è”ç³»è€å¸ˆè¿™äº›äº‹æƒ…éƒ½å¾ˆå‰å®³ï¼Œæˆ‘çœ¼ä¸­çš„ä½ åœ¨å¾ˆåšå®šåœ°æœç€ç›®çš„èµ°ï¼Œè™½ç„¶æˆ‘æ‰“ç”µè¯çš„æ—¶å€™è€æ˜¯ç¬‘ä½ ï¼Œä½†è§‰å¾—ä½ çœŸçš„æ˜¯è¶Šæ¥è¶Šå¥½äº†ã€‚
å¥½ä¼˜ç§€çš„å°å¥³å­©ã€‚
ä½ è€æ˜¯è¯´ä½ åœ¨è¿˜å‰ä¸¤å¹´çš„å€ºä»€ä¹ˆçš„ï¼Œæˆ‘è§‰å¾—ä¸æ˜¯å•Šï¼Œäººåªæœ‰è¿›æ­¥äº†ä¸€å¤§æˆªæ‰èƒ½çœ‹åˆ°è‡ªå·±ä»¥å‰å’Œç°åœ¨çš„å·®è·ï¼Œæ‰€ä»¥ä½ æ˜¯æ¯”ä»¥å‰åšçš„æ›´å¥½äº†è€Œå·²ï¼Œä»¥å‰ä¹Ÿå¾ˆå¥½ã€‚
ä½ æ˜å¹´ä¸€å®šä¼šä¸€åˆ‡é¡ºåˆ©çš„ã€‚

è‡³äºæˆ‘ï¼Œä¹Ÿæ˜¯æ²¡æƒ³åˆ°æˆ‘çš„ä»Šå¹´ä¼šè¿™ä¹ˆæˆå‰§åŒ–ã€‚
ä¸ŠåŠå¹´è¿˜ä¸ºäº†è€ƒè¯•ç†¬å¤§å¤œä¸æ­»ä¸ä¼‘ï¼Œä¸‹åŠå¹´å¿˜è®°ä½œä¸šå¿˜è®°è€ƒè¯•ï¼ˆæ˜¯çš„è¿™ä¸ªäººå› ä¸ºå¿˜è®°äº¤è®ºæ–‡æŒ‚äº†ä¸€é—¨é€‰ä¿®è¯¾ï¼‰ï¼ŒæŠ•å…¥ç‰›é©¬çš„é˜Ÿåˆ—ä¸€å»ä¸å¤è¿”äº†ã€‚
ä¸‹åŠå¹´çš„æˆ‘çœŸçš„å˜å¿«ä¹äº†ï¼Œä»¥å‰åœ¨å­¦æ ¡çš„æ—¶å€™æˆ‘æ€»è§‰å¾—æ¯å¤©ä¸çŸ¥é“åœ¨å¿™ä»€ä¹ˆï¼Œé€‰æ‹©å°±ä¸šä¹‹åï¼Œæˆ‘ç»ˆäºå¼€å§‹å­¦åˆ°çœŸå®çš„ä¸œè¥¿äº†ã€‚
æˆ‘ä¹‹å‰å…¶å®ä¹Ÿä¸€ç›´æ‡µæ‡µæ‡‚æ‡‚åœ°æƒ³ï¼Œæˆ‘å¸Œæœ›æˆ‘èƒ½å¤Ÿæ‰¾åˆ°ä¸€ä¸ªé¢†åŸŸï¼Œå½¢æˆæˆ‘çš„ä¸“é•¿å’Œç‹¬ç‰¹è§è§£ï¼Œåœ¨è¿™ä¸ªé¢†åŸŸé‡Œä¸æ–­åœ°å­¦ä¹ ï¼Œå¹¶ä¸”å¥‰çŒ®æˆ‘çš„èƒ½åŠ›å’Œæ€è€ƒã€‚
è®°ä¸è®°å¾—æˆ‘ä»¬æ‰“ç”µè¯çš„æ—¶å€™å›å¿†å»å¹´çš„ç”Ÿæ—¥æ„¿æœ›ï¼Œæˆ‘ä¹‹åæƒ³èµ·æ¥ï¼Œæˆ‘19å²çš„æ„¿æœ›å…¶å®æ˜¯ï¼Œæˆ‘å¸Œæœ›æˆ‘åœ¨20å²ä¹‹å‰æ‰¾åˆ°è‡ªå·±çœŸæ­£æƒ³åšçš„äº‹æƒ…ã€‚
è™½ç„¶ç°åœ¨è¿˜æ˜¯å¾ˆä¸ç¡®åˆ‡ï¼Œä½†ä¹Ÿç®—æ˜¯å®ç°äº†ã€‚
è€Œä¸”å…¶å®æˆ‘ä¸Šå¤§å­¦çš„æ¯ä¸€å¹´éƒ½åœ¨æƒ³ï¼Œæˆ‘è¦ä¸ç›´æ¥å°±ä¸šå§ï¼Œä¹‹å‰æ¯æ¬¡éƒ½å› ä¸ºå„ç§åŸå› ä¸æ•¢å»è¯•ï¼Œè€Œå®ä¹ äº†ä¸€æ¬¡ä¹‹åï¼Œæˆ‘æ½œæ„è¯†é‡Œå‡ ä¹å·²ç»æ²¡æœ‰è¦å»è¯»ç ”çš„æ‰“ç®—äº†ã€‚
ç„¶åå°±æ˜¯å¡«ç»¼æµ‹å¡«å‡ºé—®é¢˜äº†ï¼Œæˆ‘å¼€å§‹éƒ‘é‡è€ƒè™‘è¦ä¸è¦å°±ä¸šã€‚
å¦‚æœä½ ä¹Ÿé‡åˆ°ä¸€ç›´åœ¨å¿ƒé‡Œé‡å¤çš„å£°éŸ³ï¼Œä¸€å®šè¦è®¤çœŸå¯¹å¾…å•Šã€‚

é™¤äº†å¥½çš„ä¸€é¢ï¼Œæˆ‘ä¸‹åŠå¹´ä¹Ÿå¾ˆç„¦è™‘å’Œå®³æ€•ã€‚äººçœŸçš„å¾ˆéš¾åœ¨é‚£ä¹ˆå¤§çš„ä¸ç¡®å®šæ€§ä¸­ä¿æŒå†·é™ï¼Œåˆ«çš„æ—¶å€™è¿˜å¥½ï¼Œä¸€æ—¦é‡åˆ°äº†ä»€ä¹ˆæ›²æŠ˜å•ŠæŒ«è´¥å•Šï¼Œå¿ƒæƒ…çœŸçš„ä¼šå¾ˆç³Ÿç³•ã€‚
å¥½åœ¨æˆ‘æœ‰å¯ä»¥å¬æˆ‘è¯´è¯ç„¶åå¤¸æˆ‘é™ªä¼´æˆ‘çš„å¥½æœ‹å‹ã€‚
è°¢è°¢ä½ çš„é¼“åŠ±å’Œè‚¯å®šï¼Œæœ‰äººè¯´å¥½æœ‹å‹æ˜¯ç”Ÿæ´»çš„è§£è¯ï¼Œé‚£ä½ è‚¯å®šæ˜¯ä¿è´¨æœŸåˆå¼ºè¯æ•ˆåˆå¥½çš„é‚£ç§ï¼Œæˆ‘å°ä½ ä¸ºå¥¥å¸ä»–éŸ¦ã€‚

2025å¹´å¹´åˆæˆ‘ç®—å¡”ç½—ç‰Œçš„æ—¶å€™ï¼Œè¯´ä»Šå¹´æ˜¯å˜åŒ–çš„ä¸€å¹´ã€‚
å¤ªå‡†äº†è¿™è¯¥æ­»çš„è¥¿æ–¹ç„å­¦ï¼
ä¸ä»…æ˜¯å˜äº†æ–¹å‘ï¼Œæˆ‘æ„Ÿè§‰æˆ‘çš„ç”Ÿæ´»ä¹Ÿä¸€ç›´åœ¨å˜ï¼Œåœ¨å­¦æ ¡çš„æ—¶å€™å¥½åƒå‡ æœˆå¦‚ä¸€æ—¥ï¼Œä½†åœ¨æ ¡å¤–ï¼Œæˆ‘æ¯ä¸ªæœˆéƒ½åœ¨å˜åŒ–ï¼Œç”Ÿæ´»çš„ç§©åºã€æœ‹å‹åœˆå­ã€å­¦ä¹ çš„ä¸œè¥¿ç­‰ç­‰ï¼Œå…¨éƒ½å¾ˆä¸ä¸€æ ·äº†ã€‚å°±è¿æˆ‘æ‰€å­¦ä¹ çš„aiè¡Œä¸šï¼Œä»Šå¹´ä¹Ÿæ˜¯å¤§å˜åŒ–å¹´ã€‚
æˆ‘æ„Ÿè§‰è‡ªå·±æœ‰æ—¶å€™æœ‰ç‚¹ä¸ç¼ºå®é™…çš„çœ©æ™•ï¼Œæ˜¯é‚£ç§ç†Ÿæ‚‰çš„ä¸œè¥¿éƒ½è¢«æ‰“ç ´ã€æ–°çš„ç§©åºè¿˜æœªå½¢æˆå¯¼è‡´çš„å¤±åºæ„Ÿã€‚
ä½ ä¹Ÿä¸€æ ·å§ï¼Œåœ¨æˆ‘çœ‹ä¸è§çš„åœ°æ–¹å‘ç”Ÿäº†å¤šå°‘å˜åŒ–å‘¢ã€‚
ä¸è¿‡æˆ‘ä¹Ÿå‘ç°æœ‰ä¸€äº›åŠ¨ä½œé•¿ä¹…å›ºå®šä¸‹æ¥äº†ï¼Œæ¯”å¦‚æˆ‘å›å®¶ä¼šå…ˆå›é•¿æ²™å»æ¹–å¤§ï¼Œæ¯æ¬¡è§ä½ æ¯”è§æˆ‘çˆ¸å¦ˆè¿˜æ—©ï¼Œæˆ‘çˆ¸å¦ˆéƒ½å¾ˆéœ‡æƒŠ;è¿˜æœ‰ä¼šåœ¨æŸä¸ªå¤œæ™šå¼€å§‹æ‰“å¾ˆé•¿çš„ç”µè¯ï¼Œæˆ‘å‘ç°æˆ‘å£°éŸ³æœ‰ç‚¹å¤§ï¼Œæˆ‘çš„ç¬‘å£°å°±è¿™æ ·æ•£å¸ƒåœ¨å­¦æ ¡å„ä¸ªè§’è½ã€‚
å–œæ¬¢å›ºå®šï¼Œå–œæ¬¢å˜åŒ–ï¼Œå–œæ¬¢å˜åŒ–é‡Œé¢ä¸å˜çš„ä¸œè¥¿ï¼Œè¿™äº›ä¸œè¥¿å¦‚æ­¤é‡è¦ã€‚

å¯¹äºæœªæ¥ï¼Œæˆ‘å¾ˆå……æ»¡æœŸå¾…ã€‚
æˆ‘æœŸå¾…æˆ‘å­¦åˆ°è¶Šæ¥è¶Šå¤šçš„ä¸œè¥¿ï¼ŒæœŸå¾…é‚£ä¸ªå¤§æœ‰å¯ä¸ºçš„å°†æ¥ã€‚
ç›¸ä¿¡æˆ‘ã€‚
ç„¶åä½ åœ¨æˆ‘çœ¼é‡Œä¹Ÿä¸€ç›´æ˜¯é—ªé—ªå‘å…‰çš„ï¼Œåˆ«è€å¤¸æˆ‘ï¼Œæˆ‘è§‰å¾—ä½ å°±æ˜¯ä¼šæˆåŠŸçš„ã€‚
å†æ¬¡ç›¸ä¿¡æˆ‘ã€‚
ä½†æœ€é‡è¦çš„è¿˜æ˜¯ï¼Œç¥æˆ‘ä»¬éƒ½ä¼šè¿‡å¾—å¹¸ç¦ã€‚

æˆ‘ä»¬å¯èƒ½éƒ½ä¼šè¶Šæ¥è¶Šå¿™ï¼Œä¹Ÿä¸çŸ¥é“ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œé‚£å°±åšå¥½ç°åœ¨çš„äº‹æƒ…å§ã€‚
æˆ‘ä»¥å‰æ˜¯é‚£ç§ç‰¹åˆ«å–œæ¬¢è§„åˆ’é•¿è¿œæœªæ¥çš„ï¼Œå¥½åƒé‚£äº›ä¸€æ—¶å®ç°ä¸äº†çš„å¤§æ„¿æœ›éƒ½å¯ä»¥å¯„æ‰˜åœ¨å¯¹æœªæ¥çš„è®¡åˆ’é‡Œï¼Œä¹Ÿå¯ä»¥æš‚æ—¶ä»åº¸åº¸ç¢Œç¢Œçš„æ—¥å¸¸é‡ŒæŠ½èº«å‡ºæ¥ï¼Œæ‰¾åˆ°ä¸€ç‚¹æŒæ§æ„Ÿã€‚
ä½†å…¶å®ä»€ä¹ˆè®¡åˆ’ä¹Ÿèµ¶ä¸ä¸Šå˜åŒ–ï¼Œå°¤å…¶æ˜¯ç°åœ¨è¿™ä¸ªå¹´çºªï¼Œä¸‹ä¸€ä¸ªæœˆçš„æˆ‘å’Œè¿™ä¸€ä¸ªæœˆçš„æˆ‘æ°¸è¿œæƒ³çš„ä¸ä¸€æ ·ã€‚æœ‰ä¸€ä¸ªå¾ˆå‰å®³çš„å§å§å’Œæˆ‘è¯´ï¼Œå¥¹å·²ç»ä¸å»è®¡åˆ’æœªæ¥äº†ï¼Œä½†å¥¹å°±æ˜¯æœ‰ä¸€ç§è‡ªä¿¡ï¼Œå› ä¸ºç°åœ¨çš„å¥¹æ¯å¤©éƒ½åœ¨æˆé•¿ã€‚
è¿™æ˜¯ä¸€ç§åœ¨ä¸ç¡®å®šæ€§ä¸­å‘¼å¸çš„èƒ½åŠ›å§ï¼Œæ—¢ç„¶æˆ‘ä»¬çš„æ˜å¹´ä»Šæ—¥ä¸çŸ¥é“ä¼šæ˜¯ä»€ä¹ˆæ ·çš„ç­”æ¡ˆï¼Œé‚£å°±å¹²è„†ä¸è¦å»æƒ³äº†ã€‚
é«˜ä¸­çš„æ—¶å€™è€æ˜¯æƒ³ä»¥åï¼Œå…¶å®é‚£æ®µæ—¶é—´ä¹Ÿå¾ˆå¼€å¿ƒå•Šï¼Œä»Šå¤©ä¹Ÿä¸€æ ·ï¼Œæˆ‘è§‰å¾—æˆ‘ä»¬çš„ä»Šå¤©çœŸçš„æ˜¯æœ€å¥½çš„ã€‚
æˆ‘å¥½å–œæ¬¢é‚£äº›ç–¯ç–¯ç™«ç™«çš„é’æ˜¥æ—¶åˆ»å•Šï¼Œåœ¨å‡Œæ™¨éª‘è½¦ã€åœ¨å¤§å­¦é‡Œä¸€èµ·ä¸Šè¯¾ã€ä½ æ¥æˆ‘çš„å­¦æ ¡æ‰¾æˆ‘ã€æ¥å·å±±åªæ‰¾æˆ‘ï¼ˆè¯è¯´æˆ‘ä»Šå¹´æ˜¯ä¸æ˜¯å¾—å»ä½ å®¶æ‹œä¸ªå¹´ï¼Œæˆ‘ä¼šæ‹‰ä¸Šæˆ‘çˆ·çˆ·å¥¶å¥¶æ¥çš„ï¼‰ï¼Œè¿˜æœ‰å¥½å¤šå¥½ç©çš„äº‹æƒ…ç­‰ç€æˆ‘ä»¬å»åšã€‚ï¼ˆæ¯”å¦‚é•¿æ²™å…¬ç¤¾ï¼Œæˆ‘ä¸€å®šè¦å»çš„ï¼Œä¸€å®šè¦æ‹‰ä¸Šä½ çš„ï¼Œå•Šå•Šå•Šç”·æ¨¡ï¼‰
æˆ‘ä»¬ä¸ä¼šæ¯”ä»Šå¤©æ›´å¹´è½»äº†ï¼Œä»Šå¤©å°±æ˜¯æœ€å¥½çš„ï¼

å…³äºç¤¼ç‰©ï¼Œé¦–å…ˆæˆ‘çœŸçš„å¾ˆå–œæ¬¢ä½ çš„ç¤¼ç‰©ä»¬ï¼Œç§Ÿæˆ¿ä¸€å¼€å§‹å¾ˆå­¤ç‹¬çš„ï¼Œæ„Ÿè°¢ä½ çš„ç²å¨œè´å„¿ã€‚
æˆ‘æŒ‘äº†ä¸€ä¸ªå¥½çœ‹çš„ç›¸å†Œï¼Œä¹‹å‰çœ‹åˆ°è¿‡ä½ çš„ç›¸å†Œï¼Œå†ç»™ä½ é€ä¸€ä¸ªï¼Œåæ­£ä½ åº”è¯¥å–œæ¬¢å¼„ã€‚
è¿™ä¸€æœ¬èå¤´çš„æ—¥å†ï¼Œå°±å½“æ˜¯é™ªä½ èµ°è¿‡2026è¿™ä¸ªä¿ç ”å†²åˆºå¹´å§ï¼Œæˆ‘é«˜è€ƒé‚£ä¸€å¹´åœ¨æ¡Œä¸Šæ‘†äº†ä¸€æœ¬æœ‰å¤§å­¦ç…§ç‰‡çš„æ—¥å†ï¼Œæ­¦å¤§å¤æ—¦åŒ—å¤§æ¸…åæœ€ç»ˆé™ªç€æˆ‘è€ƒä¸Šäº†ä¼Ÿå¤§çš„ä¸­å¤®è´¢ç»å¤§å­¦ğŸ‘ğŸ»ä½ çš„èå¤´ä¹Ÿä¼šé™ªç€ä½ æ¥è§ä»–ä»¬çš„ã€‚
å°é¡¹é“¾å¥½çœ‹å§ï¼Œä½ é€æˆ‘çš„å°æ‰‹é“¾æˆ‘ä¸€ç›´åœ¨æˆ´å“¦ã€‚
é¦™è–°ç›²ç›’æ˜¯åœ¨å°çº¢ä¹¦åˆ·åˆ°çš„ï¼Œè§‰å¾—å¥½ç©åˆå¥½çœ‹ï¼Œè‡ªå·±èˆä¸å¾—ä¹°ï¼Œæ‰€ä»¥ä¹°ç»™ä½ å˜¿å˜¿ã€‚
æ¶¦å”‡è†ï¼Œå¾ˆå¥½ç”¨çš„ï¼å†¬å¤©å¤šç”¨ï¼
è¿™ä¸ªpinæ˜¯æˆéƒ½èµ›çºªå¿µæ¬¾ï¼Œä½ çš„çº¿ä¸‹è¿çœŸçš„å¥½å¥½ï¼Œè¿™è¯´æ˜ä»–ä»¬æ—ºä½ ï¼Œç»™æˆ‘æˆ´ä¸Šï¼Œæ—ºæ—ºæ—ºï¼
å¯¹äº†æ²¡æœ‰ä¹¦ï¼Œæˆ‘ä»Šå¹´å¥½åƒæ²¡æœ‰ä»€ä¹ˆå¾ˆå°è±¡æ·±åˆ»çš„ä¹¦ï¼Œè¦æ˜¯ä¸‹æ¬¡è¯»åˆ°äº†å°±ä¹°ä¸€æœ¬å¯„ç»™ä½ ã€‚
è¿˜æœ‰è¿™ä¸ªç½‘é¡µï¼Œæˆ‘å¸Œæœ›å®ƒä¸€ç›´ç•™ä¸‹å»ï¼Œç•™åœ¨æˆ‘ä»¬çš„é•¿é•¿å‹è°Šé‡Œï¼Œå˜å¾—è¶Šæ¥è¶Šæ¼‚äº®ã€‚

ç‹æ¥šé’¦è¿™é¦–æ­ŒçœŸçš„å¥½å¥½å¬å•Šï¼Œæˆ‘åšç½‘é¡µè¿™ä¸¤å¤©å¬å¥½å¤šéäº†ã€‚
â€œæ¢¦é‡Œé¢å‘“è¯­ï¼Œæ¸…é£å¾®èµ·ï¼Œæ€å¿µæ€é™äºä¸‰è¨€ä¸¤è¯­ã€‚â€

æ€å¿µä¸é™äºä¸‰è¨€ä¸¤è¯­ï¼Œ ä½†æˆ‘ä»¬æœ‰é•¿é•¿çš„ä¿¡å’Œè§ä¸å®Œçš„é¢ã€‚

ä¸‹æ¬¡è§ï¼


â€”â€”20å²çš„å¼ å¯å¦®

        </div>
    </section>

    <section id="gift" class="section content-section">
        <h2>è§£é”ç¤¼ç‰© ğŸ</h2>
        <div class="game-area">
            <p style="color:#666; margin-bottom: 20px;">ğŸ‘‡ ç¿»ç‰ŒåŒ¹é…ç›¸åŒå›¾æ¡ˆï¼Œè§£é”ç¤¼ç‰©å¯†ç </p>
            <div class="memory-grid" id="memoryGrid"></div>
            <div class="gift-reveal" id="giftReveal">
                <p>ğŸ‰ æˆåŠŸå•¦ï¼å¯†ç æ˜¯ï¼š</p>
                <div class="password-code">520</div>
                <p>âœ¨ å²å²å¹´å¹´ âœ¨</p>
                <button class="music-btn" onclick="resetGame()" style="margin-top:25px">å†ç©ä¸€æ¬¡</button>
            </div>
        </div>
    </section>

    <script>
        // ###############################################################
        // ä½ çš„ Supabase é…ç½® (æ— éœ€ä¿®æ”¹)
        // ###############################################################
        
        let allPhotoUrls = []; 
        let currentPhotoIndex = 0;
        
        const YOUR_SUPABASE_URL = 'https://xillvllktcsqrbhpuqvc.supabase.co';
        const YOUR_SUPABASE_KEY = 'sb_publishable_vyU-iDtNjxc5-yIIs2pjHw_oyYJ4qPC';

        // ###############################################################

        window.addEventListener('DOMContentLoaded', () => {
            // A. å¯¼èˆªåˆ‡æ¢
            const navLinks = document.querySelectorAll('.nav-item a');
            const sections = document.querySelectorAll('.section');
            const sliderImgs = document.querySelectorAll('.slider-img');
            let sliderInterval;
            let currentImgIndex = 0;

            function startSlider() {
                if(sliderImgs.length === 0) return;
                sliderImgs.forEach(img => img.style.display = 'none');
                sliderImgs[currentImgIndex].style.display = 'block';
                stopSlider();
                sliderInterval = setInterval(() => {
                    sliderImgs[currentImgIndex].style.display = 'none';
                    currentImgIndex = (currentImgIndex + 1) % sliderImgs.length;
                    sliderImgs[currentImgIndex].style.display = 'block';
                }, 3000);
            }
            function stopSlider() { if (sliderInterval) clearInterval(sliderInterval); }

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    navLinks.forEach(i => i.classList.remove('active'));
                    sections.forEach(s => s.classList.remove('active'));
                    link.classList.add('active');
                    const targetId = link.getAttribute('data-target');
                    const targetSection = document.getElementById(targetId);
                    if(targetSection) targetSection.classList.add('active');

                    if (targetId === 'home') startSlider();
                    else stopSlider();
                });
            });
            startSlider();

            // B. éŸ³ä¹
            const playBtn = document.getElementById('playMusicBtn');
            const audio = document.getElementById('bgMusic');
            let isPlaying = false;
            if(playBtn && audio) {
                playBtn.addEventListener('click', () => {
                    if (isPlaying) { audio.pause(); playBtn.textContent = 'ç‚¹ç‚¹æˆ‘å§ ğŸµ'; isPlaying = false; }
                    else { audio.play(); playBtn.textContent = 'æš‚åœæ’­æ”¾ â¸'; isPlaying = true; }
                });
            }

            // C. æ¸¸æˆ
            initGame();

            // D. æ•°æ®åº“
            try {
                if (!window.supabase) throw new Error("Supabase æœªåŠ è½½");
                
                const supabase = window.supabase.createClient(YOUR_SUPABASE_URL, YOUR_SUPABASE_KEY);
                window.currentSupabase = supabase;

                loadPhotos(supabase);

                const fileInput = document.getElementById('uploadInput');
                if(fileInput) {
                    fileInput.addEventListener('change', (e) => {
                        if (e.target.files.length > 0) uploadPhoto(supabase, e.target.files[0]);
                    });
                }
            } catch (err) {
                console.error("æ•°æ®åº“é”™è¯¯:", err);
                document.getElementById('dynamicGallery').innerHTML = '<p style="text-align:center;color:red;padding:20px;">âš ï¸ æ•°æ®åº“è¿æ¥å¼‚å¸¸</p>';
            }
        });

        // ================= ç›¸å†Œå‡½æ•° =================
        async function loadPhotos(supabase) {
            const gallery = document.getElementById('dynamicGallery');
            const { data, error } = await supabase.from('photos').select('*').order('created_at', { ascending: false });
            
            if (error || !data) {
                gallery.innerHTML = '<p style="text-align:center">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</p>'; return;
            }
            if (data.length === 0) {
                gallery.innerHTML = '<p style="text-align:center;color:#999;margin-top:20px;">ç›¸å†Œæ˜¯ç©ºçš„ï¼Œä¸Šä¼ ç¬¬ä¸€å¼ ç…§ç‰‡å§ ğŸ“¸</p>'; return;
            }
            
            gallery.innerHTML = ''; 
            
            // 1. é‡ç½®å…¨å±€ç›¸å†Œæ•°æ®
            allPhotoUrls = []; 
            let globalIndex = 0; // ç”¨äºç»™æ¯å¼ ç…§ç‰‡æ‰“ä¸Šåºå·

            const groups = {};
            data.forEach(p => { const y = p.caption||'å…¶å®ƒ'; if(!groups[y]) groups[y]=[]; groups[y].push(p); });

            // æŒ‰å¹´ä»½æ’åºï¼ˆå¤§çš„åœ¨å‰ï¼‰
            Object.keys(groups).sort().reverse().forEach(year => {
                const div = document.createElement('div');
                div.innerHTML = `<div style="text-align:left"><div class="year-badge">${year}</div></div><div class="img-grid"></div>`;
                const grid = div.querySelector('.img-grid');
                
                groups[year].forEach(photo => {
                    // 2. å°† URL åŠ å…¥å…¨å±€æ•°ç»„
                    allPhotoUrls.push(photo.url);

                    const item = document.createElement('div');
                    item.className = 'img-item';
                    
                    // 3. ä¿®æ”¹ onclickï¼Œä¼ å…¥ globalIndex è€Œä¸æ˜¯ url
                    item.innerHTML = `
                        <img src="${photo.url}" loading="lazy" onclick="openLightbox(${globalIndex})">
                        <button class="delete-btn" onclick="deletePhoto('${photo.id}','${photo.url}', event)" title="åˆ é™¤ç…§ç‰‡">Ã—</button>
                    `;
                    grid.appendChild(item);
                    
                    // åºå·åŠ 1
                    globalIndex++;
                });
                gallery.appendChild(div);
            });
        }

        async function uploadPhoto(supabase, file) {
            const status = document.getElementById('uploadStatus');
            status.textContent = 'â³ å›¾ç‰‡ä¸Šä¼ ä¸­...';
            const fileName = `${Date.now()}_${Math.floor(Math.random()*9999)}`;
            
            const { error: upErr } = await supabase.storage.from('images').upload(fileName, file);
            if (upErr) { status.textContent = 'âŒ ä¸Šä¼ å¤±è´¥: ' + upErr.message; return; }
            
            const { data: { publicUrl } } = supabase.storage.from('images').getPublicUrl(fileName);
            const year = document.getElementById('yearSelect').value;
            const { error: dbErr } = await supabase.from('photos').insert([{ url: publicUrl, caption: year }]);
            
            if (dbErr) { status.textContent = 'âŒ ä¿å­˜è®°å½•å¤±è´¥'; }
            else { status.textContent = 'âœ… ä¸Šä¼ æˆåŠŸï¼'; loadPhotos(supabase); }
        }

        async function deletePhoto(id, url, event) {
            if(event) event.stopPropagation();
            if(!confirm('ç¡®å®šè¦åˆ é™¤è¿™å¼ ç…§ç‰‡å—ï¼Ÿ')) return;
            
            const supabase = window.currentSupabase;
            if(!supabase) return;
            
            const { error } = await supabase.from('photos').delete().eq('id', id);
            if (!error) {
                const fileName = url.split('/').pop();
                await supabase.storage.from('images').remove([fileName]);
                loadPhotos(supabase);
            } else {
                alert("åˆ é™¤å¤±è´¥");
            }
        }

        // ================= ç¯ç®±ä¸é”®ç›˜å¯¼èˆª =================
        
        // æ‰“å¼€ç¯ç®±ï¼Œæ¥æ”¶ç´¢å¼•
// ================= ç¯ç®±ä¸é”®ç›˜å¯¼èˆª (ä¿®å¤ç‰ˆ) =================
        
        function openLightbox(indexOrUrl) {
            const lightbox = document.getElementById('lightbox');
            const img = document.getElementById('lightbox-img');
            
            // è°ƒè¯•ä¿¡æ¯ï¼šå¯ä»¥åœ¨æµè§ˆå™¨æ§åˆ¶å°çœ‹åˆ°å…·ä½“ä¼ è¿›æ¥äº†ä»€ä¹ˆ
            console.log("æ­£åœ¨æ‰“å¼€ç¯ç®±ï¼Œä¼ å…¥å‚æ•°:", indexOrUrl);
            console.log("å½“å‰ç…§ç‰‡åˆ—è¡¨:", allPhotoUrls);

            // æƒ…å†µAï¼šä¼ å…¥çš„æ˜¯æ•°å­—ï¼ˆè¯´æ˜ loadPhotos æ›´æ–°æˆåŠŸäº†ï¼‰
            if (typeof indexOrUrl === 'number') {
                currentPhotoIndex = indexOrUrl;
                if (allPhotoUrls[indexOrUrl]) {
                    img.src = allPhotoUrls[indexOrUrl];
                } else {
                    console.error("æ‰¾ä¸åˆ°è¿™å¼ ç…§ç‰‡çš„é“¾æ¥ï¼Œç´¢å¼•:", indexOrUrl);
                }
            } 
            // æƒ…å†µBï¼šä¼ å…¥çš„æ˜¯é“¾æ¥å­—ç¬¦ä¸²ï¼ˆè¯´æ˜è¿˜åœ¨ç”¨æ—§çš„ HTMLï¼Œæˆ–è€…ç¼“å­˜æ²¡æ¸…ï¼‰
            else if (typeof indexOrUrl === 'string') {
                img.src = indexOrUrl;
                // å°è¯•åå‘æŸ¥æ‰¾è¿™å¼ å›¾æ˜¯åˆ—è¡¨é‡Œçš„ç¬¬å‡ å¼ ï¼Œä¸ºäº†è®©é”®ç›˜èƒ½ç”¨
                const foundIndex = allPhotoUrls.indexOf(indexOrUrl);
                if (foundIndex !== -1) {
                    currentPhotoIndex = foundIndex;
                } else {
                    // å¦‚æœåˆ—è¡¨é‡Œå±…ç„¶æ²¡æœ‰è¿™å¼ å›¾ï¼Œå°±æ‰‹åŠ¨æŠŠå®ƒåŠ è¿›å»ï¼Œé˜²æ­¢æŠ¥é”™
                    allPhotoUrls.push(indexOrUrl);
                    currentPhotoIndex = allPhotoUrls.length - 1;
                }
            }

            lightbox.classList.add('active');
        }

        // å…³é—­ç¯ç®±
        function closeLightbox() {
            document.getElementById('lightbox').classList.remove('active');
            setTimeout(() => { document.getElementById('lightbox-img').src = ''; }, 300);
        }

        // åˆ‡æ¢å›¾ç‰‡
        function switchPhoto(direction) {
            const newIndex = currentPhotoIndex + direction;
            if (newIndex >= 0 && newIndex < allPhotoUrls.length) {
                currentPhotoIndex = newIndex;
                const img = document.getElementById('lightbox-img');
                img.style.opacity = 0.5;
                setTimeout(() => {
                    img.src = allPhotoUrls[currentPhotoIndex];
                    img.style.opacity = 1;
                }, 100);
            }
        }

        // é”®ç›˜ç›‘å¬
        document.addEventListener('keydown', (e) => {
            const lightbox = document.getElementById('lightbox');
            if (!lightbox.classList.contains('active')) return;
            if (e.key === 'ArrowLeft') switchPhoto(-1);
            else if (e.key === 'ArrowRight') switchPhoto(1);
            else if (e.key === 'Escape') closeLightbox();
        });

        // ... (ä¸‹é¢æ¥åŸæœ‰çš„ // ================= æ¸¸æˆ ================= ä»£ç )

        // ================= æ¸¸æˆ =================
        const emojis = ['ğŸ§¸','ğŸ§¸','ğŸ€','ğŸ€','ğŸŸ','ğŸŸ','ğŸˆ','ğŸˆ','ğŸ°','ğŸ°','ğŸ','ğŸ'];
        let hasFlipped=false, lockBoard=false, first, second, matchCount=0;
        
        function initGame() {
            const grid = document.getElementById('memoryGrid');
            if(!grid) return;
            grid.innerHTML = ''; matchCount=0;
            document.getElementById('giftReveal').style.display='none';
            document.getElementById('memoryGrid').style.display='grid';
            emojis.sort(()=>0.5-Math.random()).forEach(e => {
                const c = document.createElement('div');
                c.className='memory-card'; c.dataset.fw=e;
                c.innerHTML=`<div class="front-face">${e}</div><div class="back-face"></div>`;
                c.addEventListener('click', flipCard);
                grid.appendChild(c);
            });
        }
        function flipCard() {
            if(lockBoard || this===first) return;
            this.classList.add('flip');
            if(!hasFlipped) { hasFlipped=true; first=this; return; }
            second=this; checkForMatch();
        }
        function checkForMatch() {
            let isMatch = first.dataset.fw === second.dataset.fw;
            isMatch ? disableCards() : unflipCards();
        }
        function disableCards() {
            first.removeEventListener('click', flipCard); second.removeEventListener('click', flipCard);
            resetBoard(); matchCount++;
            if(matchCount === emojis.length/2) setTimeout(gameWin, 800);
        }
        function unflipCards() {
            lockBoard=true;
            setTimeout(() => { first.classList.remove('flip'); second.classList.remove('flip'); resetBoard(); }, 1000);
        }
        function resetBoard() { [hasFlipped, lockBoard]=[false, false]; [first, second]=[null, null]; }
        function gameWin() {
            document.getElementById('memoryGrid').style.display='none';
            document.getElementById('giftReveal').style.display='block';
            startFireworks();
        }
        function resetGame() { stopFireworks(); initGame(); }

        // ================= çƒŸèŠ± =================
        const canvas = document.getElementById('fireworksCanvas');
        const ctx = canvas.getContext('2d');
        let particles=[], animationId;
        function resizeCanvas() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.addEventListener('resize', resizeCanvas); resizeCanvas();
        class Confetti {
            constructor() {
                this.x = Math.random()*canvas.width; this.y = Math.random()*canvas.height - canvas.height;
                this.size = Math.random()*12+6; this.color = `hsl(${Math.random()*360}, 100%, 75%)`;
                this.speedY = Math.random()*3+2; this.speedX = Math.random()*2-1; this.rot = Math.random()*360;
            }
            update() { this.y+=this.speedY; this.x+=this.speedX; this.rot+=5; if(this.y>canvas.height) this.y=-20; }
            draw() { ctx.save(); ctx.translate(this.x, this.y); ctx.rotate(this.rot*Math.PI/180); ctx.fillStyle=this.color; ctx.fillRect(-this.size/2,-this.size/2,this.size,this.size); ctx.restore(); }
        }
        function startFireworks() { particles=[]; for(let i=0; i<120; i++) particles.push(new Confetti()); animate(); }
        function animate() { ctx.clearRect(0,0,canvas.width,canvas.height); particles.forEach(p=>{p.update();p.draw();}); animationId=requestAnimationFrame(animate); }
        function stopFireworks() { cancelAnimationFrame(animationId); ctx.clearRect(0,0,canvas.width,canvas.height); }
    </script>
</body>
</html>